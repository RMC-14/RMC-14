using Robust.Client.AutoGenerated;
using Robust.Client.Graphics;
using Robust.Client.UserInterface;
using Robust.Client.UserInterface.Controls;
using Robust.Client.UserInterface.XAML;
using Robust.Shared.Utility;

namespace Content.Client._RMC14.Xenonids.UI;

[GenerateTypedNameReferences]
[Virtual]
public partial class XenoChoiceControl : Control
{
    private static readonly Color LeaderColor = Color.FromHex("#FFBF00");
    private static readonly Color PlasmaColor = Color.FromHex("#1576BE");
    private static readonly Color PlasmaHighlightColor = Color.FromHex("#3590D3");
    private static readonly Color HealColor = Color.FromHex("#236C40");
    private static readonly Color HealHighlightColor = Color.FromHex("#36A964");

    public XenoChoiceControl()
    {
        RobustXamlLoader.Load(this);
        Plasma.ForegroundStyleBoxOverride = new StyleBoxFlat(Color.LightSkyBlue);
        Health.ForegroundStyleBoxOverride = new StyleBoxFlat(Color.LimeGreen);
        LeaderBox.ModulateSelfOverride = LeaderColor;

        PlasmaButton.ModulateSelfOverride = PlasmaColor;
        HealButton.ModulateSelfOverride = HealColor;
        PlasmaButton.OnMouseEntered += OnHovered;
        PlasmaButton.OnMouseExited += OnStopHovering;
        HealButton.OnMouseEntered += OnHovered;
        HealButton.OnMouseExited += OnStopHovering;
    }

    public void Set(string name, Texture? texture)
    {
        NameLabel.SetMessage(name);
        Texture.Texture = texture;
    }

    public void Set(FormattedMessage msg, Texture? texture)
    {
        NameLabel.SetMessage(msg);
        Texture.Texture = texture;
    }

    public void SetName(string name)
    {
        Button.Name = name.Replace(" ","");
    }

    public void SetLeader(Texture? texture)
    {
        LeaderStar.Texture = texture;
        LeaderStar.Visible = true;
        LeaderBox.Visible = true;
        LeaderBar.Visible = true;
    }

    public void SetHealth(float health)
    {
        Health.Value = health;
        if (health <= 0)
            Health.BackgroundStyleBoxOverride = new StyleBoxFlat(Color.Red);
        else
            Health.BackgroundStyleBoxOverride = new StyleBoxFlat(Color.Gray);

        Health.Visible = true;
    }

    public void SetPlasma(float plasma)
    {
        Plasma.Value = plasma;
        Plasma.Visible = true;
    }

    public void SetEvo(int evo)
    {
        EvoPoints.Text = $"Evo: {evo}";
        EvoPoints.Visible = true;
    }


    public void OnHovered(GUIMouseHoverEventArgs args)
    {
        if (args.SourceControl is not Button button)
            return;

            button.ModulateSelfOverride = (button.Name) switch
            {
                ("HealButton") => HealHighlightColor,
                ("PlasmaButton") => PlasmaHighlightColor,
                _ => throw new ArgumentOutOfRangeException()
            };
    }

    public void OnStopHovering(GUIMouseHoverEventArgs args)
    {
        if (args.SourceControl is not Button button)
            return;

        button.ModulateSelfOverride = (button.Name) switch
        {
            ("HealButton") => HealColor,
            ("PlasmaButton") => PlasmaColor,
            _ => throw new ArgumentOutOfRangeException()
        };
    }

}
