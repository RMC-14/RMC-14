using Content.Client.UserInterface.Controls;
using Robust.Client.AutoGenerated;
using Robust.Client.UserInterface;
using Robust.Client.UserInterface.XAML;
using Robust.Shared.GameObjects;

namespace Content.Client._RMC14.Comms;

[GenerateTypedNameReferences]
public sealed partial class EncryptionCoderComputerWindow : FancyWindow
{
    public event Action<int>? ChangeOffset;
    public event Action? SubmitCode;
    [Dependency] private readonly IEntityManager _entityManager = default!;
    public string LastSubmittedCode
    {
        get => LastSubmittedCodeLabel.Text ?? "None";
        set => LastSubmittedCodeLabel.Text = value;
    }

    public int KnownLetters
    {
        get => int.TryParse(KnownLettersLabel.Text, out var i) ? i : 0;
        set => KnownLettersLabel.Text = value.ToString();
    }

    public string ClarityDescription
    {
        get => ClarityDescriptionLabel.Text ?? "unknown";
        set => ClarityDescriptionLabel.Text = value;
    }

    public string CurrentWord
    {
        get => WordLabel.Text ?? "";
        set => WordLabel.Text = value;
    }

    public int CurrentOffset
    {
        get => int.TryParse(OffsetLabel.Text, out var o) ? o : 0;
        set => OffsetLabel.Text = value.ToString();
    }

    public EncryptionCoderComputerWindow()
    {
        IoCManager.InjectDependencies(this);
        RobustXamlLoader.Load(this);

        DecreaseOffsetButton.OnPressed += _ => ChangeOffset?.Invoke(-1);
        IncreaseOffsetButton.OnPressed += _ => ChangeOffset?.Invoke(1);
        SubmitButton.OnPressed += _ => SubmitCode?.Invoke();
    }
}
