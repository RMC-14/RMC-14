using Content.Client.UserInterface.Controls;
using Robust.Client.AutoGenerated;
using Robust.Client.UserInterface;
using Robust.Client.UserInterface.XAML;

namespace Content.Client._RMC14.Comms;

[GenerateTypedNameReferences]
public sealed partial class EncryptionCoderComputerWindow : FancyWindow
{
    public event Action<string>? SubmitCode;

    public string LastSubmittedCode
    {
        get => LastSubmittedCodeLabel.Text ?? "";
        set => LastSubmittedCodeLabel.Text = value;
    }

    public int KnownLetters
    {
        get => int.TryParse(KnownLettersLabel.Text ?? "0", out var letters) ? letters : 0;
        set => KnownLettersLabel.Text = value.ToString();
    }

    public string ClarityDescription
    {
        get => ClarityDescriptionLabel.Text ?? "unknown";
        set => ClarityDescriptionLabel.Text = value;
    }

    public EncryptionCoderComputerWindow()
    {
        RobustXamlLoader.Load(this);

        CodeInput.OnTextEntered += args =>
        {
            if (!string.IsNullOrWhiteSpace(args.Text))
            {
                SubmitCode?.Invoke(args.Text.ToUpper());
                CodeInput.Text = "";
            }
        };

        SubmitButton.OnPressed += _ =>
        {
            if (!string.IsNullOrWhiteSpace(CodeInput.Text))
            {
                SubmitCode?.Invoke(CodeInput.Text.ToUpper());
                CodeInput.Text = "";
            }
        };
    }
}
