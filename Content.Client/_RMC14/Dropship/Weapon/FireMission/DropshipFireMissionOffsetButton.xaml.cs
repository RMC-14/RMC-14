using Robust.Client.AutoGenerated;
using Robust.Client.Graphics;
using Robust.Client.UserInterface.Controls;
using Robust.Client.UserInterface.XAML;
using Robust.Shared.Utility;

namespace Content.Client._RMC14.Dropship.Weapon.FireMission;

[GenerateTypedNameReferences]
public sealed partial class DropshipFireMissionOffsetButton : Button
{
    private Action<ButtonEventArgs>? _onPressed;
    public int? Offset { get; set; }

    public DropshipFireMissionOffsetButton()
    {
        RobustXamlLoader.Load(this);
    }

    private StyleBoxFlat ActiveStyleBox()
    {
        return new StyleBoxFlat
        {
            BackgroundColor = Color.FromHex("#00FF36"), //TODO make this Color.Transparent
            BorderColor = Color.FromHex("#00FF36"),
            BorderThickness = new Thickness(2),
        };
    }

    public void Refresh()
    {
        Disabled = string.IsNullOrEmpty(FormattedMessage.RemoveMarkupPermissive(RichLabel.GetMessage() ?? string.Empty));
        var box = ActiveStyleBox();
        if (Disabled)
        {
            box.BackgroundColor = Color.Transparent;
            box.BorderColor = Color.Transparent;
        }
        StyleBoxOverride = box;
    }

    public void SetOnPressed(Action<ButtonEventArgs>? action)
    {
        OnPressed -= _onPressed;
        if (action == null)
            return;

        _onPressed = action;
        OnPressed += action;
    }
}
