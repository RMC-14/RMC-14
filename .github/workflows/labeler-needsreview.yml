name: "Labels: Review"

on:
  pull_request_target:
    types: [review_requested, opened]

env:
  TARGET_TEAM_SLG: "maintainers"
  LABEL_TO_REMOVE: "S: Awaiting Changes"

jobs:
  add_label:
    runs-on: ubuntu-latest
    steps:
    - uses: actions-ecosystem/action-add-labels@v1
      with:
        labels: "S: Needs Review"
    - uses: actions-ecosystem/action-remove-labels@v1
      with:
        labels: "S: Awaiting Changes"
  remove-tag:
    runs-on: ubuntu-latest
    if: github.event.requested_team || github.event.requested_reviewer

    steps:
    - name: Checkout Code
      uses: actions/checkout@v4

    - name: Setup .NET
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: '8.0.x'

    - name: Build and Run
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        REPOSITORY: ${{ github.repository }}
        PR_NUMBER: ${{ github.event.pull_request.number }}
        REQUESTED_REVIEWER: ${{ github.event.requested_reviewer.login }}
        REQUESTED_TEAM: ${{ github.event.requested_team.name }}
        TAG_TO_REMOVE: "S: Awaiting Changes"

      run: |
        dotnet build Content.GitHubActions --configuration Release
        dotnet run --project Content.GitHubActions
